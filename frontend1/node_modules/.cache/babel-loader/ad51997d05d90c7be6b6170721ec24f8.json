{"ast":null,"code":"import _slicedToArray from\"C:/Users/gamer/OneDrive/Bureau/go my code - Copie/frontend1/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import React,{Fragment,useState,useEffect}from'react';import{Carousel}from'react-bootstrap';import Loader from'../layout/Loader';import MetaData from'../layout/MetaData';import ListReviews from'../review/ListReviews';import{useAlert}from'react-alert';import{useDispatch,useSelector}from'react-redux';import{getProductDetails,newReview,clearErrors}from'../../actions/productActions';import{addItemToCart}from'../../actions/cartActions';import{NEW_REVIEW_RESET}from'../../constants/productConstants';var ProductDetails=function ProductDetails(_ref){var match=_ref.match;var _useState=useState(1),_useState2=_slicedToArray(_useState,2),quantity=_useState2[0],setQuantity=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),rating=_useState4[0],setRating=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),comment=_useState6[0],setComment=_useState6[1];var dispatch=useDispatch();var alert=useAlert();var _useSelector=useSelector(function(state){return state.productDetails;}),loading=_useSelector.loading,error=_useSelector.error,product=_useSelector.product;var _useSelector2=useSelector(function(state){return state.auth;}),user=_useSelector2.user;var _useSelector3=useSelector(function(state){return state.newReview;}),reviewError=_useSelector3.error,success=_useSelector3.success;useEffect(function(){dispatch(getProductDetails(match.params.id));if(error){alert.error(error);dispatch(clearErrors());}if(reviewError){alert.error(reviewError);dispatch(clearErrors());}if(success){alert.success('Reivew posted successfully');dispatch({type:NEW_REVIEW_RESET});}},[dispatch,alert,error,reviewError,match.params.id,success]);var addToCart=function addToCart(){dispatch(addItemToCart(match.params.id,quantity));alert.success('Item Added to Cart');};var increaseQty=function increaseQty(){var count=document.querySelector('.count');if(count.valueAsNumber>=product.stock)return;var qty=count.valueAsNumber+1;setQuantity(qty);};var decreaseQty=function decreaseQty(){var count=document.querySelector('.count');if(count.valueAsNumber<=1)return;var qty=count.valueAsNumber-1;setQuantity(qty);};function setUserRatings(){var stars=document.querySelectorAll('.star');stars.forEach(function(star,index){star.starValue=index+1;['click','mouseover','mouseout'].forEach(function(e){star.addEventListener(e,showRatings);});});function showRatings(e){var _this=this;stars.forEach(function(star,index){if(e.type==='click'){if(index<_this.starValue){star.classList.add('orange');setRating(_this.starValue);}else{star.classList.remove('orange');}}if(e.type==='mouseover'){if(index<_this.starValue){star.classList.add('yellow');}else{star.classList.remove('yellow');}}if(e.type==='mouseout'){star.classList.remove('yellow');}});}}var reviewHandler=function reviewHandler(){var formData=new FormData();formData.set('rating',rating);formData.set('comment',comment);formData.set('productId',match.params.id);dispatch(newReview(formData));};return/*#__PURE__*/_jsx(Fragment,{children:loading?/*#__PURE__*/_jsx(Loader,{}):/*#__PURE__*/_jsxs(Fragment,{children:[/*#__PURE__*/_jsx(MetaData,{title:product.name}),/*#__PURE__*/_jsxs(\"div\",{className:\"row d-flex justify-content-around\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col-12 col-lg-5 img-fluid\",id:\"product_image\",children:/*#__PURE__*/_jsx(Carousel,{pause:\"hover\",children:product.images&&product.images.map(function(image){return/*#__PURE__*/_jsx(Carousel.Item,{children:/*#__PURE__*/_jsx(\"img\",{className:\"d-block w-100\",src:image.url,alt:product.title})},image.public_id);})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-12 col-lg-5 mt-5\",children:[/*#__PURE__*/_jsx(\"h3\",{children:product.name}),/*#__PURE__*/_jsxs(\"p\",{id:\"product_id\",children:[\"Product # \",product._id]}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsx(\"div\",{className:\"rating-outer\",children:/*#__PURE__*/_jsx(\"div\",{className:\"rating-inner\",style:{width:\"\".concat(product.ratings/5*100,\"%\")}})}),/*#__PURE__*/_jsxs(\"span\",{id:\"no_of_reviews\",children:[\"(\",product.numOfReviews,\" Reviews)\"]}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(\"p\",{id:\"product_price\",children:[\"$\",product.price]}),/*#__PURE__*/_jsxs(\"div\",{className:\"stockCounter d-inline\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"btn btn-danger minus\",onClick:decreaseQty,children:\"-\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",className:\"form-control count d-inline\",value:quantity,readOnly:true}),/*#__PURE__*/_jsx(\"span\",{className:\"btn btn-primary plus\",onClick:increaseQty,children:\"+\"})]}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",id:\"cart_btn\",className:\"btn btn-primary d-inline ml-4\",disabled:product.stock===0,onClick:addToCart,children:\"Add to Cart\"}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Status: \",/*#__PURE__*/_jsx(\"span\",{id:\"stock_status\",className:product.stock>0?'greenColor':'redColor',children:product.stock>0?'In Stock':'Out of Stock'})]}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsx(\"h4\",{className:\"mt-2\",children:\"Description:\"}),/*#__PURE__*/_jsx(\"p\",{children:product.description}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(\"p\",{id:\"product_seller mb-3\",children:[\"Sold by: \",/*#__PURE__*/_jsx(\"strong\",{children:product.seller})]}),user?/*#__PURE__*/_jsx(\"button\",{id:\"review_btn\",type:\"button\",className:\"btn btn-primary mt-4\",\"data-toggle\":\"modal\",\"data-target\":\"#ratingModal\",onClick:setUserRatings,children:\"Submit Your Review\"}):/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-danger mt-5\",type:\"alert\",children:\"Login to post your review.\"}),/*#__PURE__*/_jsx(\"div\",{className:\"row mt-2 mb-5\",children:/*#__PURE__*/_jsx(\"div\",{className:\"rating w-50\",children:/*#__PURE__*/_jsx(\"div\",{className:\"modal fade\",id:\"ratingModal\",tabIndex:\"-1\",role:\"dialog\",\"aria-labelledby\":\"ratingModalLabel\",\"aria-hidden\":\"true\",children:/*#__PURE__*/_jsx(\"div\",{className:\"modal-dialog\",role:\"document\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"modal-title\",id:\"ratingModalLabel\",children:\"Submit Review\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"close\",\"data-dismiss\":\"modal\",\"aria-label\":\"Close\",children:/*#__PURE__*/_jsx(\"span\",{\"aria-hidden\":\"true\",children:\"\\xD7\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-body\",children:[/*#__PURE__*/_jsxs(\"ul\",{className:\"stars\",children:[/*#__PURE__*/_jsx(\"li\",{className:\"star\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-star\"})}),/*#__PURE__*/_jsx(\"li\",{className:\"star\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-star\"})}),/*#__PURE__*/_jsx(\"li\",{className:\"star\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-star\"})}),/*#__PURE__*/_jsx(\"li\",{className:\"star\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-star\"})}),/*#__PURE__*/_jsx(\"li\",{className:\"star\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-star\"})})]}),/*#__PURE__*/_jsx(\"textarea\",{name:\"review\",id:\"review\",className:\"form-control mt-3\",value:comment,onChange:function onChange(e){return setComment(e.target.value);}}),/*#__PURE__*/_jsx(\"button\",{className:\"btn my-3 float-right review-btn px-4 text-white\",onClick:reviewHandler,\"data-dismiss\":\"modal\",\"aria-label\":\"Close\",children:\"Submit\"})]})]})})})})})]})]}),product.reviews&&product.reviews.length>0&&/*#__PURE__*/_jsx(ListReviews,{reviews:product.reviews})]})});};export default ProductDetails;","map":{"version":3,"sources":["C:/Users/gamer/OneDrive/Bureau/go my code - Copie/frontend1/src/components/product/ProductDetails.js"],"names":["React","Fragment","useState","useEffect","Carousel","Loader","MetaData","ListReviews","useAlert","useDispatch","useSelector","getProductDetails","newReview","clearErrors","addItemToCart","NEW_REVIEW_RESET","ProductDetails","match","quantity","setQuantity","rating","setRating","comment","setComment","dispatch","alert","state","productDetails","loading","error","product","auth","user","reviewError","success","params","id","type","addToCart","increaseQty","count","document","querySelector","valueAsNumber","stock","qty","decreaseQty","setUserRatings","stars","querySelectorAll","forEach","star","index","starValue","e","addEventListener","showRatings","classList","add","remove","reviewHandler","formData","FormData","set","name","images","map","image","url","title","public_id","_id","width","ratings","numOfReviews","price","description","seller","target","value","reviews","length"],"mappings":"0QAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,QAA1B,CAAoCC,SAApC,KAAqD,OAArD,CACA,OAASC,QAAT,KAAyB,iBAAzB,CAEA,MAAOC,CAAAA,MAAP,KAAmB,kBAAnB,CACA,MAAOC,CAAAA,QAAP,KAAqB,oBAArB,CACA,MAAOC,CAAAA,WAAP,KAAwB,uBAAxB,CAEA,OAASC,QAAT,KAAyB,aAAzB,CACA,OAASC,WAAT,CAAsBC,WAAtB,KAAyC,aAAzC,CACA,OAASC,iBAAT,CAA4BC,SAA5B,CAAuCC,WAAvC,KAA0D,8BAA1D,CACA,OAASC,aAAT,KAA8B,2BAA9B,CACA,OAASC,gBAAT,KAAiC,kCAAjC,CAEA,GAAMC,CAAAA,cAAc,CAAG,QAAjBA,CAAAA,cAAiB,MAAe,IAAZC,CAAAA,KAAY,MAAZA,KAAY,eAEFf,QAAQ,CAAC,CAAD,CAFN,wCAE3BgB,QAF2B,eAEjBC,WAFiB,8BAGNjB,QAAQ,CAAC,CAAD,CAHF,yCAG3BkB,MAH2B,eAGnBC,SAHmB,8BAIJnB,QAAQ,CAAC,EAAD,CAJJ,yCAI3BoB,OAJ2B,eAIlBC,UAJkB,eAMlC,GAAMC,CAAAA,QAAQ,CAAGf,WAAW,EAA5B,CACA,GAAMgB,CAAAA,KAAK,CAAGjB,QAAQ,EAAtB,CAPkC,iBASEE,WAAW,CAAC,SAAAgB,KAAK,QAAIA,CAAAA,KAAK,CAACC,cAAV,EAAN,CATb,CAS1BC,OAT0B,cAS1BA,OAT0B,CASjBC,KATiB,cASjBA,KATiB,CASVC,OATU,cASVA,OATU,mBAUjBpB,WAAW,CAAC,SAAAgB,KAAK,QAAIA,CAAAA,KAAK,CAACK,IAAV,EAAN,CAVM,CAU1BC,IAV0B,eAU1BA,IAV0B,mBAWMtB,WAAW,CAAC,SAAAgB,KAAK,QAAIA,CAAAA,KAAK,CAACd,SAAV,EAAN,CAXjB,CAWnBqB,WAXmB,eAW1BJ,KAX0B,CAWNK,OAXM,eAWNA,OAXM,CAalC/B,SAAS,CAAC,UAAM,CACZqB,QAAQ,CAACb,iBAAiB,CAACM,KAAK,CAACkB,MAAN,CAAaC,EAAd,CAAlB,CAAR,CAEA,GAAIP,KAAJ,CAAW,CACPJ,KAAK,CAACI,KAAN,CAAYA,KAAZ,EACAL,QAAQ,CAACX,WAAW,EAAZ,CAAR,CACH,CAED,GAAIoB,WAAJ,CAAiB,CACbR,KAAK,CAACI,KAAN,CAAYI,WAAZ,EACAT,QAAQ,CAACX,WAAW,EAAZ,CAAR,CACH,CAED,GAAIqB,OAAJ,CAAa,CACTT,KAAK,CAACS,OAAN,CAAc,4BAAd,EACAV,QAAQ,CAAC,CAAEa,IAAI,CAAEtB,gBAAR,CAAD,CAAR,CACH,CAEJ,CAlBQ,CAkBN,CAACS,QAAD,CAAWC,KAAX,CAAkBI,KAAlB,CAAyBI,WAAzB,CAAsChB,KAAK,CAACkB,MAAN,CAAaC,EAAnD,CAAuDF,OAAvD,CAlBM,CAAT,CAoBA,GAAMI,CAAAA,SAAS,CAAG,QAAZA,CAAAA,SAAY,EAAM,CACpBd,QAAQ,CAACV,aAAa,CAACG,KAAK,CAACkB,MAAN,CAAaC,EAAd,CAAkBlB,QAAlB,CAAd,CAAR,CACAO,KAAK,CAACS,OAAN,CAAc,oBAAd,EACH,CAHD,CAKA,GAAMK,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,EAAM,CACtB,GAAMC,CAAAA,KAAK,CAAGC,QAAQ,CAACC,aAAT,CAAuB,QAAvB,CAAd,CAEA,GAAIF,KAAK,CAACG,aAAN,EAAuBb,OAAO,CAACc,KAAnC,CAA0C,OAE1C,GAAMC,CAAAA,GAAG,CAAGL,KAAK,CAACG,aAAN,CAAsB,CAAlC,CACAxB,WAAW,CAAC0B,GAAD,CAAX,CACH,CAPD,CASA,GAAMC,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,EAAM,CAEtB,GAAMN,CAAAA,KAAK,CAAGC,QAAQ,CAACC,aAAT,CAAuB,QAAvB,CAAd,CAEA,GAAIF,KAAK,CAACG,aAAN,EAAuB,CAA3B,CAA8B,OAE9B,GAAME,CAAAA,GAAG,CAAGL,KAAK,CAACG,aAAN,CAAsB,CAAlC,CACAxB,WAAW,CAAC0B,GAAD,CAAX,CAEH,CATD,CAWA,QAASE,CAAAA,cAAT,EAA0B,CACtB,GAAMC,CAAAA,KAAK,CAAGP,QAAQ,CAACQ,gBAAT,CAA0B,OAA1B,CAAd,CAEAD,KAAK,CAACE,OAAN,CAAc,SAACC,IAAD,CAAOC,KAAP,CAAiB,CAC3BD,IAAI,CAACE,SAAL,CAAiBD,KAAK,CAAG,CAAzB,CAEA,CAAC,OAAD,CAAU,WAAV,CAAuB,UAAvB,EAAmCF,OAAnC,CAA2C,SAAUI,CAAV,CAAa,CACpDH,IAAI,CAACI,gBAAL,CAAsBD,CAAtB,CAAyBE,WAAzB,EACH,CAFD,EAGH,CAND,EAQA,QAASA,CAAAA,WAAT,CAAqBF,CAArB,CAAwB,gBACpBN,KAAK,CAACE,OAAN,CAAc,SAACC,IAAD,CAAOC,KAAP,CAAiB,CAC3B,GAAIE,CAAC,CAACjB,IAAF,GAAW,OAAf,CAAwB,CACpB,GAAIe,KAAK,CAAG,KAAI,CAACC,SAAjB,CAA4B,CACxBF,IAAI,CAACM,SAAL,CAAeC,GAAf,CAAmB,QAAnB,EAEArC,SAAS,CAAC,KAAI,CAACgC,SAAN,CAAT,CACH,CAJD,IAIO,CACHF,IAAI,CAACM,SAAL,CAAeE,MAAf,CAAsB,QAAtB,EACH,CACJ,CAED,GAAIL,CAAC,CAACjB,IAAF,GAAW,WAAf,CAA4B,CACxB,GAAIe,KAAK,CAAG,KAAI,CAACC,SAAjB,CAA4B,CACxBF,IAAI,CAACM,SAAL,CAAeC,GAAf,CAAmB,QAAnB,EACH,CAFD,IAEO,CACHP,IAAI,CAACM,SAAL,CAAeE,MAAf,CAAsB,QAAtB,EACH,CACJ,CAED,GAAIL,CAAC,CAACjB,IAAF,GAAW,UAAf,CAA2B,CACvBc,IAAI,CAACM,SAAL,CAAeE,MAAf,CAAsB,QAAtB,EACH,CACJ,CAtBD,EAuBH,CACJ,CAED,GAAMC,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,EAAM,CACxB,GAAMC,CAAAA,QAAQ,CAAG,GAAIC,CAAAA,QAAJ,EAAjB,CAEAD,QAAQ,CAACE,GAAT,CAAa,QAAb,CAAuB3C,MAAvB,EACAyC,QAAQ,CAACE,GAAT,CAAa,SAAb,CAAwBzC,OAAxB,EACAuC,QAAQ,CAACE,GAAT,CAAa,WAAb,CAA0B9C,KAAK,CAACkB,MAAN,CAAaC,EAAvC,EAEAZ,QAAQ,CAACZ,SAAS,CAACiD,QAAD,CAAV,CAAR,CACH,CARD,CAUA,mBACI,KAAC,QAAD,WACKjC,OAAO,cAAG,KAAC,MAAD,IAAH,cACJ,MAAC,QAAD,yBACI,KAAC,QAAD,EAAU,KAAK,CAAEE,OAAO,CAACkC,IAAzB,EADJ,cAEI,aAAK,SAAS,CAAC,mCAAf,wBACI,YAAK,SAAS,CAAC,2BAAf,CAA2C,EAAE,CAAC,eAA9C,uBACI,KAAC,QAAD,EAAU,KAAK,CAAC,OAAhB,UACKlC,OAAO,CAACmC,MAAR,EAAkBnC,OAAO,CAACmC,MAAR,CAAeC,GAAf,CAAmB,SAAAC,KAAK,qBACvC,KAAC,QAAD,CAAU,IAAV,wBACI,YAAK,SAAS,CAAC,eAAf,CAA+B,GAAG,CAAEA,KAAK,CAACC,GAA1C,CAA+C,GAAG,CAAEtC,OAAO,CAACuC,KAA5D,EADJ,EAAoBF,KAAK,CAACG,SAA1B,CADuC,EAAxB,CADvB,EADJ,EADJ,cAWI,aAAK,SAAS,CAAC,sBAAf,wBACI,oBAAKxC,OAAO,CAACkC,IAAb,EADJ,cAEI,WAAG,EAAE,CAAC,YAAN,wBAA8BlC,OAAO,CAACyC,GAAtC,GAFJ,cAII,aAJJ,cAMI,YAAK,SAAS,CAAC,cAAf,uBACI,YAAK,SAAS,CAAC,cAAf,CAA8B,KAAK,CAAE,CAAEC,KAAK,WAAM1C,OAAO,CAAC2C,OAAR,CAAkB,CAAnB,CAAwB,GAA7B,KAAP,CAArC,EADJ,EANJ,cASI,cAAM,EAAE,CAAC,eAAT,eAA2B3C,OAAO,CAAC4C,YAAnC,eATJ,cAWI,aAXJ,cAaI,WAAG,EAAE,CAAC,eAAN,eAAwB5C,OAAO,CAAC6C,KAAhC,GAbJ,cAcI,aAAK,SAAS,CAAC,uBAAf,wBACI,aAAM,SAAS,CAAC,sBAAhB,CAAuC,OAAO,CAAE7B,WAAhD,eADJ,cAGI,cAAO,IAAI,CAAC,QAAZ,CAAqB,SAAS,CAAC,6BAA/B,CAA6D,KAAK,CAAE5B,QAApE,CAA8E,QAAQ,KAAtF,EAHJ,cAKI,aAAM,SAAS,CAAC,sBAAhB,CAAuC,OAAO,CAAEqB,WAAhD,eALJ,GAdJ,cAqBI,eAAQ,IAAI,CAAC,QAAb,CAAsB,EAAE,CAAC,UAAzB,CAAoC,SAAS,CAAC,+BAA9C,CAA8E,QAAQ,CAAET,OAAO,CAACc,KAAR,GAAkB,CAA1G,CAA6G,OAAO,CAAEN,SAAtH,yBArBJ,cAuBI,aAvBJ,cAyBI,6CAAW,aAAM,EAAE,CAAC,cAAT,CAAwB,SAAS,CAAER,OAAO,CAACc,KAAR,CAAgB,CAAhB,CAAoB,YAApB,CAAmC,UAAtE,UAAoFd,OAAO,CAACc,KAAR,CAAgB,CAAhB,CAAoB,UAApB,CAAiC,cAArH,EAAX,GAzBJ,cA2BI,aA3BJ,cA6BI,WAAI,SAAS,CAAC,MAAd,0BA7BJ,cA8BI,mBAAId,OAAO,CAAC8C,WAAZ,EA9BJ,cA+BI,aA/BJ,cAgCI,WAAG,EAAE,CAAC,qBAAN,oCAAqC,wBAAS9C,OAAO,CAAC+C,MAAjB,EAArC,GAhCJ,CAkCK7C,IAAI,cAAG,eAAQ,EAAE,CAAC,YAAX,CAAwB,IAAI,CAAC,QAA7B,CAAsC,SAAS,CAAC,sBAAhD,CAAuE,cAAY,OAAnF,CAA2F,cAAY,cAAvG,CAAsH,OAAO,CAAEe,cAA/H,gCAAH,cAID,YAAK,SAAS,CAAC,yBAAf,CAAyC,IAAI,CAAC,OAA9C,wCAtCR,cA0CI,YAAK,SAAS,CAAC,eAAf,uBACI,YAAK,SAAS,CAAC,aAAf,uBAEI,YAAK,SAAS,CAAC,YAAf,CAA4B,EAAE,CAAC,aAA/B,CAA6C,QAAQ,CAAC,IAAtD,CAA2D,IAAI,CAAC,QAAhE,CAAyE,kBAAgB,kBAAzF,CAA4G,cAAY,MAAxH,uBACI,YAAK,SAAS,CAAC,cAAf,CAA8B,IAAI,CAAC,UAAnC,uBACI,aAAK,SAAS,CAAC,eAAf,wBACI,aAAK,SAAS,CAAC,cAAf,wBACI,WAAI,SAAS,CAAC,aAAd,CAA4B,EAAE,CAAC,kBAA/B,2BADJ,cAEI,eAAQ,IAAI,CAAC,QAAb,CAAsB,SAAS,CAAC,OAAhC,CAAwC,eAAa,OAArD,CAA6D,aAAW,OAAxE,uBACI,aAAM,cAAY,MAAlB,kBADJ,EAFJ,GADJ,cAOI,aAAK,SAAS,CAAC,YAAf,wBAEI,YAAI,SAAS,CAAC,OAAd,wBACI,WAAI,SAAS,CAAC,MAAd,uBAAqB,UAAG,SAAS,CAAC,YAAb,EAArB,EADJ,cAEI,WAAI,SAAS,CAAC,MAAd,uBAAqB,UAAG,SAAS,CAAC,YAAb,EAArB,EAFJ,cAGI,WAAI,SAAS,CAAC,MAAd,uBAAqB,UAAG,SAAS,CAAC,YAAb,EAArB,EAHJ,cAII,WAAI,SAAS,CAAC,MAAd,uBAAqB,UAAG,SAAS,CAAC,YAAb,EAArB,EAJJ,cAKI,WAAI,SAAS,CAAC,MAAd,uBAAqB,UAAG,SAAS,CAAC,YAAb,EAArB,EALJ,GAFJ,cAUI,iBACI,IAAI,CAAC,QADT,CAEI,EAAE,CAAC,QAFP,CAEgB,SAAS,CAAC,mBAF1B,CAGI,KAAK,CAAEzB,OAHX,CAII,QAAQ,CAAE,kBAACgC,CAAD,QAAO/B,CAAAA,UAAU,CAAC+B,CAAC,CAACwB,MAAF,CAASC,KAAV,CAAjB,EAJd,EAVJ,cAmBI,eAAQ,SAAS,CAAC,iDAAlB,CAAoE,OAAO,CAAEnB,aAA7E,CAA4F,eAAa,OAAzG,CAAiH,aAAW,OAA5H,oBAnBJ,GAPJ,GADJ,EADJ,EAFJ,EADJ,EA1CJ,GAXJ,GAFJ,CAiGK9B,OAAO,CAACkD,OAAR,EAAmBlD,OAAO,CAACkD,OAAR,CAAgBC,MAAhB,CAAyB,CAA5C,eACG,KAAC,WAAD,EAAa,OAAO,CAAEnD,OAAO,CAACkD,OAA9B,EAlGR,GAFR,EADJ,CA4GH,CAtND,CAwNA,cAAehE,CAAAA,cAAf","sourcesContent":["import React, { Fragment, useState, useEffect } from 'react'\nimport { Carousel } from 'react-bootstrap'\n\nimport Loader from '../layout/Loader'\nimport MetaData from '../layout/MetaData'\nimport ListReviews from '../review/ListReviews'\n\nimport { useAlert } from 'react-alert'\nimport { useDispatch, useSelector } from 'react-redux'\nimport { getProductDetails, newReview, clearErrors } from '../../actions/productActions'\nimport { addItemToCart } from '../../actions/cartActions'\nimport { NEW_REVIEW_RESET } from '../../constants/productConstants'\n\nconst ProductDetails = ({ match }) => {\n\n    const [quantity, setQuantity] = useState(1)\n    const [rating, setRating] = useState(0);\n    const [comment, setComment] = useState('');\n\n    const dispatch = useDispatch();\n    const alert = useAlert();\n\n    const { loading, error, product } = useSelector(state => state.productDetails)\n    const { user } = useSelector(state => state.auth)\n    const { error: reviewError, success } = useSelector(state => state.newReview)\n\n    useEffect(() => {\n        dispatch(getProductDetails(match.params.id))\n\n        if (error) {\n            alert.error(error);\n            dispatch(clearErrors())\n        }\n\n        if (reviewError) {\n            alert.error(reviewError);\n            dispatch(clearErrors())\n        }\n\n        if (success) {\n            alert.success('Reivew posted successfully')\n            dispatch({ type: NEW_REVIEW_RESET })\n        }\n\n    }, [dispatch, alert, error, reviewError, match.params.id, success])\n\n    const addToCart = () => {\n        dispatch(addItemToCart(match.params.id, quantity));\n        alert.success('Item Added to Cart')\n    }\n\n    const increaseQty = () => {\n        const count = document.querySelector('.count')\n\n        if (count.valueAsNumber >= product.stock) return;\n\n        const qty = count.valueAsNumber + 1;\n        setQuantity(qty)\n    }\n\n    const decreaseQty = () => {\n\n        const count = document.querySelector('.count')\n\n        if (count.valueAsNumber <= 1) return;\n\n        const qty = count.valueAsNumber - 1;\n        setQuantity(qty)\n\n    }\n\n    function setUserRatings() {\n        const stars = document.querySelectorAll('.star');\n\n        stars.forEach((star, index) => {\n            star.starValue = index + 1;\n\n            ['click', 'mouseover', 'mouseout'].forEach(function (e) {\n                star.addEventListener(e, showRatings);\n            })\n        })\n\n        function showRatings(e) {\n            stars.forEach((star, index) => {\n                if (e.type === 'click') {\n                    if (index < this.starValue) {\n                        star.classList.add('orange');\n\n                        setRating(this.starValue)\n                    } else {\n                        star.classList.remove('orange')\n                    }\n                }\n\n                if (e.type === 'mouseover') {\n                    if (index < this.starValue) {\n                        star.classList.add('yellow');\n                    } else {\n                        star.classList.remove('yellow')\n                    }\n                }\n\n                if (e.type === 'mouseout') {\n                    star.classList.remove('yellow')\n                }\n            })\n        }\n    }\n\n    const reviewHandler = () => {\n        const formData = new FormData();\n\n        formData.set('rating', rating);\n        formData.set('comment', comment);\n        formData.set('productId', match.params.id);\n\n        dispatch(newReview(formData));\n    }\n\n    return (\n        <Fragment>\n            {loading ? <Loader /> : (\n                <Fragment>\n                    <MetaData title={product.name} />\n                    <div className=\"row d-flex justify-content-around\">\n                        <div className=\"col-12 col-lg-5 img-fluid\" id=\"product_image\">\n                            <Carousel pause='hover'>\n                                {product.images && product.images.map(image => (\n                                    <Carousel.Item key={image.public_id}>\n                                        <img className=\"d-block w-100\" src={image.url} alt={product.title} />\n                                    </Carousel.Item>\n                                ))}\n                            </Carousel>\n                        </div>\n\n                        <div className=\"col-12 col-lg-5 mt-5\">\n                            <h3>{product.name}</h3>\n                            <p id=\"product_id\">Product # {product._id}</p>\n\n                            <hr />\n\n                            <div className=\"rating-outer\">\n                                <div className=\"rating-inner\" style={{ width: `${(product.ratings / 5) * 100}%` }}></div>\n                            </div>\n                            <span id=\"no_of_reviews\">({product.numOfReviews} Reviews)</span>\n\n                            <hr />\n\n                            <p id=\"product_price\">${product.price}</p>\n                            <div className=\"stockCounter d-inline\">\n                                <span className=\"btn btn-danger minus\" onClick={decreaseQty}>-</span>\n\n                                <input type=\"number\" className=\"form-control count d-inline\" value={quantity} readOnly />\n\n                                <span className=\"btn btn-primary plus\" onClick={increaseQty}>+</span>\n                            </div>\n                            <button type=\"button\" id=\"cart_btn\" className=\"btn btn-primary d-inline ml-4\" disabled={product.stock === 0} onClick={addToCart}>Add to Cart</button>\n\n                            <hr />\n\n                            <p>Status: <span id=\"stock_status\" className={product.stock > 0 ? 'greenColor' : 'redColor'} >{product.stock > 0 ? 'In Stock' : 'Out of Stock'}</span></p>\n\n                            <hr />\n\n                            <h4 className=\"mt-2\">Description:</h4>\n                            <p>{product.description}</p>\n                            <hr />\n                            <p id=\"product_seller mb-3\">Sold by: <strong>{product.seller}</strong></p>\n\n                            {user ? <button id=\"review_btn\" type=\"button\" className=\"btn btn-primary mt-4\" data-toggle=\"modal\" data-target=\"#ratingModal\" onClick={setUserRatings}>\n                                Submit Your Review\n                            </button>\n                                :\n                                <div className=\"alert alert-danger mt-5\" type='alert'>Login to post your review.</div>\n                            }\n\n\n                            <div className=\"row mt-2 mb-5\">\n                                <div className=\"rating w-50\">\n\n                                    <div className=\"modal fade\" id=\"ratingModal\" tabIndex=\"-1\" role=\"dialog\" aria-labelledby=\"ratingModalLabel\" aria-hidden=\"true\">\n                                        <div className=\"modal-dialog\" role=\"document\">\n                                            <div className=\"modal-content\">\n                                                <div className=\"modal-header\">\n                                                    <h5 className=\"modal-title\" id=\"ratingModalLabel\">Submit Review</h5>\n                                                    <button type=\"button\" className=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n                                                        <span aria-hidden=\"true\">&times;</span>\n                                                    </button>\n                                                </div>\n                                                <div className=\"modal-body\">\n\n                                                    <ul className=\"stars\" >\n                                                        <li className=\"star\"><i className=\"fa fa-star\"></i></li>\n                                                        <li className=\"star\"><i className=\"fa fa-star\"></i></li>\n                                                        <li className=\"star\"><i className=\"fa fa-star\"></i></li>\n                                                        <li className=\"star\"><i className=\"fa fa-star\"></i></li>\n                                                        <li className=\"star\"><i className=\"fa fa-star\"></i></li>\n                                                    </ul>\n\n                                                    <textarea\n                                                        name=\"review\"\n                                                        id=\"review\" className=\"form-control mt-3\"\n                                                        value={comment}\n                                                        onChange={(e) => setComment(e.target.value)}\n                                                    >\n\n                                                    </textarea>\n\n                                                    <button className=\"btn my-3 float-right review-btn px-4 text-white\" onClick={reviewHandler} data-dismiss=\"modal\" aria-label=\"Close\">Submit</button>\n                                                </div>\n                                            </div>\n                                        </div>\n                                    </div>\n\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n\n                    {product.reviews && product.reviews.length > 0 && (\n                        <ListReviews reviews={product.reviews} />\n                    )}\n\n                </Fragment>\n            )}\n        </Fragment>\n    )\n}\n\nexport default ProductDetails\n"]},"metadata":{},"sourceType":"module"}